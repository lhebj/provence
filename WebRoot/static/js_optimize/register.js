function register_show(){if($("#mask").length>0){return true}var A=$("#register-tmpl").html();$("body").append(A);mask_init()}function close_register(){$("#mask").remove();$(".mask-level").remove()}function mask_init(){var A=$("#mask");$(".close",A).on("click",close_register);$(".register",A).on("click",ajax_register);$("[name='username']",A).on("blur",check_user);$("[name='email']",A).on("blur",check_email);form_date_select()}function form_date_select(){var A="";var G=new Date().getFullYear();end_year=G-90;for(var D=G;D>end_year;D--){A+="<option value='"+D+"'>"+D+"</option>"}$(".year-select").html(A);var F="";var E=[1,2,3,4,5,6,7,8,9,10,11,12];for(var D in E){var C=E[D];if(C<10){C="0"+C}F+="<option value='"+C+"'>"+E[D]+"</option>"}$(".month-select").html(F);var B="";for(var D=1;D<=30;D++){var C=D;if(C<10){C="0"+C}B+="<option value='"+C+"'>"+D+"</option>"}$(".day-select").html(B)}function ajax_register(){var E=$("[name='username']").val(),G=$("[name='sex']:checked").val(),H=$("[name='email']").val(),A=$("[name='dateBirthday']").val(),B=$("[name='mobile']").val(),L=$("[name='address']").val(),J=$("[name='zipcode']").val(),C=$("[name='city']").val();country=$("[name='country']").val();var I=$("[name='year']").val(),F=$("[name='month']").val(),K=$("[name='day']").val();A=I+"-"+F+"-"+K;var D={username:E,sex:G,email:H,dateBirthday:A,mobile:B,address:L,zipcode:J,city:C,country:country};if(E.replace("/^s|s$/g","")==""){alert("用户名不能为空")}if(H.replace("/^s|s$/g","")==""){alert("邮箱不能为空")}$.ajax({url:"register.do",type:"POST",dataType:"json",data:D,success:function(M){if(M.success==false){alert(M.message)}else{close_register();alert("注册成功")}}})}function check_user(){var A=$("[name='username']").val();$.ajax({url:"userCheck.do?action=username",type:"GET",datatype:"json",data:"username="+A,success:function(B){B=$.parseJSON(B);if(B.success==true){$(".user-success-message").show();$(".user-error-message").hide()}else{$(".user-error-message").show();$(".user-success-message").hide()}}})}function check_email(){var A=$("[name='email']").val();$.ajax({url:"userCheck.do?action=email",type:"GET",datatype:"json",data:"email="+A,success:function(B){B=$.parseJSON(B);if(B.success==true){$(".email-success-message").show();$(".email-error-message").hide()}else{$(".email-error-message").show();$(".email-success-message").hide()}}})};